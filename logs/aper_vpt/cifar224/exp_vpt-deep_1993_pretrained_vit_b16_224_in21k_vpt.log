2024-08-25 14:05:31,296 [trainer.py] => config: exps/aper_vpt-deep/cifar224_5_5_vit-b_vpt-deep.json
2024-08-25 14:05:31,297 [trainer.py] => prefix: exp_vpt-deep
2024-08-25 14:05:31,297 [trainer.py] => dataset: cifar224
2024-08-25 14:05:31,297 [trainer.py] => memory_size: 2000
2024-08-25 14:05:31,297 [trainer.py] => memory_per_class: 20
2024-08-25 14:05:31,297 [trainer.py] => fixed_memory: False
2024-08-25 14:05:31,297 [trainer.py] => shuffle: True
2024-08-25 14:05:31,297 [trainer.py] => init_cls: 5
2024-08-25 14:05:31,297 [trainer.py] => increment: 5
2024-08-25 14:05:31,297 [trainer.py] => model_name: aper_vpt
2024-08-25 14:05:31,297 [trainer.py] => convnet_type: pretrained_vit_b16_224_in21k_vpt
2024-08-25 14:05:31,297 [trainer.py] => weight_decay: 0.0005
2024-08-25 14:05:31,297 [trainer.py] => vpt_type: deep
2024-08-25 14:05:31,297 [trainer.py] => prompt_token_num: 5
2024-08-25 14:05:31,297 [trainer.py] => min_lr: 0
2024-08-25 14:05:31,297 [trainer.py] => optimizer: sgd
2024-08-25 14:05:31,297 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-25 14:05:31,297 [trainer.py] => seed: 1993
2024-08-25 14:05:31,297 [trainer.py] => tuned_epoch: 5
2024-08-25 14:05:31,297 [trainer.py] => init_lr: 0.05
2024-08-25 14:05:31,297 [trainer.py] => batch_size: 16
2024-08-25 14:05:33,301 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-25 14:05:37,799 [trainer.py] => All params: 85844736
2024-08-25 14:05:37,800 [trainer.py] => Trainable params: 46080
2024-08-25 14:05:42,616 [aper_vpt.py] => Learning on 0-5
2024-08-25 14:06:44,945 [aper_vpt.py] => Task 0, Epoch 5/5 => Loss 0.123, Train_accy 96.16, Test_accy 99.60
2024-08-25 14:07:04,872 [trainer.py] => No NME accuracy.
2024-08-25 14:07:04,873 [trainer.py] => CNN: {'total': 99.6, '00-09': 99.6, 'old': 0, 'new': 99.6}
2024-08-25 14:07:04,873 [trainer.py] => CNN top1 curve: [99.6]
2024-08-25 14:07:04,873 [trainer.py] => CNN top5 curve: [100.0]

2024-08-25 14:07:04,873 [trainer.py] => Average Accuracy (CNN): 99.6
2024-08-25 14:07:04,874 [trainer.py] => All params: 171651073
2024-08-25 14:07:04,876 [trainer.py] => Trainable params: 85852417
2024-08-25 14:07:04,883 [aper_vpt.py] => Learning on 5-10
2024-08-25 14:07:18,204 [trainer.py] => No NME accuracy.
2024-08-25 14:07:18,204 [trainer.py] => CNN: {'total': 97.3, '00-09': 97.3, 'old': 98.6, 'new': 96.0}
2024-08-25 14:07:18,205 [trainer.py] => CNN top1 curve: [99.6, 97.3]
2024-08-25 14:07:18,205 [trainer.py] => CNN top5 curve: [100.0, 99.9]

2024-08-25 14:07:18,205 [trainer.py] => Average Accuracy (CNN): 98.44999999999999
2024-08-25 14:07:18,206 [trainer.py] => All params: 171658753
2024-08-25 14:07:18,207 [trainer.py] => Trainable params: 85860097
2024-08-25 14:07:18,209 [aper_vpt.py] => Learning on 10-15
2024-08-25 14:07:34,133 [trainer.py] => No NME accuracy.
2024-08-25 14:07:34,133 [trainer.py] => CNN: {'total': 95.2, '00-09': 95.9, '10-19': 93.8, 'old': 95.9, 'new': 93.8}
2024-08-25 14:07:34,134 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2]
2024-08-25 14:07:34,134 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67]

2024-08-25 14:07:34,134 [trainer.py] => Average Accuracy (CNN): 97.36666666666666
2024-08-25 14:07:34,135 [trainer.py] => All params: 171666433
2024-08-25 14:07:34,136 [trainer.py] => Trainable params: 85867777
2024-08-25 14:07:34,141 [aper_vpt.py] => Learning on 15-20
2024-08-25 14:07:52,546 [trainer.py] => No NME accuracy.
2024-08-25 14:07:52,546 [trainer.py] => CNN: {'total': 93.9, '00-09': 95.4, '10-19': 92.4, 'old': 94.73, 'new': 91.4}
2024-08-25 14:07:52,546 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9]
2024-08-25 14:07:52,546 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55]

2024-08-25 14:07:52,546 [trainer.py] => Average Accuracy (CNN): 96.5
2024-08-25 14:07:52,548 [trainer.py] => All params: 171674113
2024-08-25 14:07:52,549 [trainer.py] => Trainable params: 85875457
2024-08-25 14:07:52,553 [aper_vpt.py] => Learning on 20-25
2024-08-25 14:08:12,769 [trainer.py] => No NME accuracy.
2024-08-25 14:08:12,770 [trainer.py] => CNN: {'total': 93.36, '00-09': 95.3, '10-19': 91.5, '20-29': 93.2, 'old': 93.4, 'new': 93.2}
2024-08-25 14:08:12,770 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36]
2024-08-25 14:08:12,770 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2]

2024-08-25 14:08:12,770 [trainer.py] => Average Accuracy (CNN): 95.872
2024-08-25 14:08:12,771 [trainer.py] => All params: 171681793
2024-08-25 14:08:12,772 [trainer.py] => Trainable params: 85883137
2024-08-25 14:08:12,774 [aper_vpt.py] => Learning on 25-30
2024-08-25 14:08:34,681 [trainer.py] => No NME accuracy.
2024-08-25 14:08:34,682 [trainer.py] => CNN: {'total': 92.53, '00-09': 93.5, '10-19': 90.9, '20-29': 93.2, 'old': 92.4, 'new': 93.2}
2024-08-25 14:08:34,682 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53]
2024-08-25 14:08:34,682 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0]

2024-08-25 14:08:34,682 [trainer.py] => Average Accuracy (CNN): 95.315
2024-08-25 14:08:34,683 [trainer.py] => All params: 171689473
2024-08-25 14:08:34,684 [trainer.py] => Trainable params: 85890817
2024-08-25 14:08:34,688 [aper_vpt.py] => Learning on 30-35
2024-08-25 14:08:58,734 [trainer.py] => No NME accuracy.
2024-08-25 14:08:58,735 [trainer.py] => CNN: {'total': 90.2, '00-09': 92.6, '10-19': 89.4, '20-29': 91.9, '30-39': 83.6, 'old': 91.3, 'new': 83.6}
2024-08-25 14:08:58,735 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2]
2024-08-25 14:08:58,735 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77]

2024-08-25 14:08:58,735 [trainer.py] => Average Accuracy (CNN): 94.58428571428571
2024-08-25 14:08:58,736 [trainer.py] => All params: 171697153
2024-08-25 14:08:58,737 [trainer.py] => Trainable params: 85898497
2024-08-25 14:08:58,743 [aper_vpt.py] => Learning on 35-40
2024-08-25 14:09:23,665 [trainer.py] => No NME accuracy.
2024-08-25 14:09:23,665 [trainer.py] => CNN: {'total': 89.78, '00-09': 91.8, '10-19': 88.5, '20-29': 91.1, '30-39': 87.7, 'old': 89.43, 'new': 92.2}
2024-08-25 14:09:23,665 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78]
2024-08-25 14:09:23,665 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55]

2024-08-25 14:09:23,666 [trainer.py] => Average Accuracy (CNN): 93.98375
2024-08-25 14:09:23,667 [trainer.py] => All params: 171704833
2024-08-25 14:09:23,668 [trainer.py] => Trainable params: 85906177
2024-08-25 14:09:23,670 [aper_vpt.py] => Learning on 40-45
2024-08-25 14:09:50,441 [trainer.py] => No NME accuracy.
2024-08-25 14:09:50,442 [trainer.py] => CNN: {'total': 89.09, '00-09': 91.3, '10-19': 87.1, '20-29': 90.9, '30-39': 87.4, '40-49': 88.4, 'old': 89.18, 'new': 88.4}
2024-08-25 14:09:50,442 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09]
2024-08-25 14:09:50,442 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38]

2024-08-25 14:09:50,442 [trainer.py] => Average Accuracy (CNN): 93.44
2024-08-25 14:09:50,443 [trainer.py] => All params: 171712513
2024-08-25 14:09:50,444 [trainer.py] => Trainable params: 85913857
2024-08-25 14:09:50,447 [aper_vpt.py] => Learning on 45-50
2024-08-25 14:10:19,340 [trainer.py] => No NME accuracy.
2024-08-25 14:10:19,341 [trainer.py] => CNN: {'total': 88.3, '00-09': 90.8, '10-19': 86.6, '20-29': 89.7, '30-39': 85.2, '40-49': 89.2, 'old': 88.11, 'new': 90.0}
2024-08-25 14:10:19,341 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3]
2024-08-25 14:10:19,341 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26]

2024-08-25 14:10:19,341 [trainer.py] => Average Accuracy (CNN): 92.926
2024-08-25 14:10:19,342 [trainer.py] => All params: 171720193
2024-08-25 14:10:19,343 [trainer.py] => Trainable params: 85921537
2024-08-25 14:10:19,348 [aper_vpt.py] => Learning on 50-55
2024-08-25 14:10:50,305 [trainer.py] => No NME accuracy.
2024-08-25 14:10:50,305 [trainer.py] => CNN: {'total': 86.96, '00-09': 90.0, '10-19': 86.3, '20-29': 88.6, '30-39': 84.7, '40-49': 87.6, '50-59': 82.2, 'old': 87.44, 'new': 82.2}
2024-08-25 14:10:50,305 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96]
2024-08-25 14:10:50,305 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95]

2024-08-25 14:10:50,305 [trainer.py] => Average Accuracy (CNN): 92.38363636363637
2024-08-25 14:10:50,307 [trainer.py] => All params: 171727873
2024-08-25 14:10:50,308 [trainer.py] => Trainable params: 85929217
2024-08-25 14:10:50,312 [aper_vpt.py] => Learning on 55-60
2024-08-25 14:11:23,339 [trainer.py] => No NME accuracy.
2024-08-25 14:11:23,339 [trainer.py] => CNN: {'total': 86.77, '00-09': 89.7, '10-19': 86.0, '20-29': 88.4, '30-39': 84.4, '40-49': 87.5, '50-59': 84.6, 'old': 86.75, 'new': 87.0}
2024-08-25 14:11:23,339 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77]
2024-08-25 14:11:23,339 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57]

2024-08-25 14:11:23,340 [trainer.py] => Average Accuracy (CNN): 91.91583333333334
2024-08-25 14:11:23,341 [trainer.py] => All params: 171735553
2024-08-25 14:11:23,342 [trainer.py] => Trainable params: 85936897
2024-08-25 14:11:23,347 [aper_vpt.py] => Learning on 60-65
2024-08-25 14:11:46,058 [trainer.py] => No NME accuracy.
2024-08-25 14:11:46,058 [trainer.py] => CNN: {'total': 86.34, '00-09': 89.5, '10-19': 85.6, '20-29': 88.4, '30-39': 84.0, '40-49': 87.5, '50-59': 82.2, '60-69': 88.0, 'old': 86.2, 'new': 88.0}
2024-08-25 14:11:46,058 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34]
2024-08-25 14:11:46,058 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45]

2024-08-25 14:11:46,058 [trainer.py] => Average Accuracy (CNN): 91.48692307692308
2024-08-25 14:11:46,060 [trainer.py] => All params: 171743233
2024-08-25 14:11:46,061 [trainer.py] => Trainable params: 85944577
2024-08-25 14:11:46,063 [aper_vpt.py] => Learning on 65-70
2024-08-25 14:12:06,538 [trainer.py] => No NME accuracy.
2024-08-25 14:12:06,538 [trainer.py] => CNN: {'total': 86.41, '00-09': 88.9, '10-19': 85.2, '20-29': 88.4, '30-39': 83.9, '40-49': 87.3, '50-59': 82.1, '60-69': 89.1, 'old': 86.05, 'new': 91.2}
2024-08-25 14:12:06,538 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41]
2024-08-25 14:12:06,539 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39]

2024-08-25 14:12:06,539 [trainer.py] => Average Accuracy (CNN): 91.12428571428572
2024-08-25 14:12:06,540 [trainer.py] => All params: 171750913
2024-08-25 14:12:06,541 [trainer.py] => Trainable params: 85952257
2024-08-25 14:12:06,543 [aper_vpt.py] => Learning on 70-75
2024-08-25 14:12:27,950 [trainer.py] => No NME accuracy.
2024-08-25 14:12:27,951 [trainer.py] => CNN: {'total': 85.25, '00-09': 88.5, '10-19': 84.0, '20-29': 88.2, '30-39': 83.0, '40-49': 87.1, '50-59': 81.3, '60-69': 87.2, '70-79': 80.2, 'old': 85.61, 'new': 80.2}
2024-08-25 14:12:27,951 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41, 85.25]
2024-08-25 14:12:27,951 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39, 97.08]

2024-08-25 14:12:27,951 [trainer.py] => Average Accuracy (CNN): 90.73266666666667
2024-08-25 14:12:27,952 [trainer.py] => All params: 171758593
2024-08-25 14:12:27,953 [trainer.py] => Trainable params: 85959937
2024-08-25 14:12:27,955 [aper_vpt.py] => Learning on 75-80
2024-08-25 14:12:50,400 [trainer.py] => No NME accuracy.
2024-08-25 14:12:50,400 [trainer.py] => CNN: {'total': 84.05, '00-09': 88.3, '10-19': 84.0, '20-29': 88.2, '30-39': 83.0, '40-49': 85.3, '50-59': 79.3, '60-69': 86.9, '70-79': 77.4, 'old': 84.63, 'new': 75.4}
2024-08-25 14:12:50,400 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41, 85.25, 84.05]
2024-08-25 14:12:50,400 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39, 97.08, 96.84]

2024-08-25 14:12:50,400 [trainer.py] => Average Accuracy (CNN): 90.315
2024-08-25 14:12:50,401 [trainer.py] => All params: 171766273
2024-08-25 14:12:50,403 [trainer.py] => Trainable params: 85967617
2024-08-25 14:12:50,405 [aper_vpt.py] => Learning on 80-85
2024-08-25 14:13:18,318 [trainer.py] => No NME accuracy.
2024-08-25 14:13:18,318 [trainer.py] => CNN: {'total': 83.75, '00-09': 87.8, '10-19': 83.5, '20-29': 87.8, '30-39': 82.5, '40-49': 84.1, '50-59': 79.0, '60-69': 86.1, '70-79': 77.3, '80-89': 87.6, 'old': 83.51, 'new': 87.6}
2024-08-25 14:13:18,318 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41, 85.25, 84.05, 83.75]
2024-08-25 14:13:18,318 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39, 97.08, 96.84, 96.84]

2024-08-25 14:13:18,318 [trainer.py] => Average Accuracy (CNN): 89.92882352941176
2024-08-25 14:13:18,319 [trainer.py] => All params: 171773953
2024-08-25 14:13:18,321 [trainer.py] => Trainable params: 85975297
2024-08-25 14:13:18,323 [aper_vpt.py] => Learning on 85-90
2024-08-25 14:13:52,532 [trainer.py] => No NME accuracy.
2024-08-25 14:13:52,532 [trainer.py] => CNN: {'total': 83.38, '00-09': 87.6, '10-19': 82.8, '20-29': 87.8, '30-39': 82.5, '40-49': 84.1, '50-59': 78.9, '60-69': 86.1, '70-79': 76.6, '80-89': 84.0, 'old': 83.55, 'new': 80.4}
2024-08-25 14:13:52,533 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41, 85.25, 84.05, 83.75, 83.38]
2024-08-25 14:13:52,533 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39, 97.08, 96.84, 96.84, 96.42]

2024-08-25 14:13:52,533 [trainer.py] => Average Accuracy (CNN): 89.565
2024-08-25 14:13:52,534 [trainer.py] => All params: 171781633
2024-08-25 14:13:52,535 [trainer.py] => Trainable params: 85982977
2024-08-25 14:13:52,539 [aper_vpt.py] => Learning on 90-95
2024-08-25 14:14:36,681 [trainer.py] => No NME accuracy.
2024-08-25 14:14:36,681 [trainer.py] => CNN: {'total': 83.29, '00-09': 87.1, '10-19': 82.4, '20-29': 87.3, '30-39': 82.2, '40-49': 83.4, '50-59': 78.3, '60-69': 85.8, '70-79': 75.9, '80-89': 83.9, '90-99': 90.0, 'old': 82.92, 'new': 90.0}
2024-08-25 14:14:36,681 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41, 85.25, 84.05, 83.75, 83.38, 83.29]
2024-08-25 14:14:36,682 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39, 97.08, 96.84, 96.84, 96.42, 96.39]

2024-08-25 14:14:36,682 [trainer.py] => Average Accuracy (CNN): 89.23473684210526
2024-08-25 14:14:36,683 [trainer.py] => All params: 171789313
2024-08-25 14:14:36,684 [trainer.py] => Trainable params: 85990657
2024-08-25 14:14:36,686 [aper_vpt.py] => Learning on 95-100
2024-08-25 14:15:32,244 [trainer.py] => No NME accuracy.
2024-08-25 14:15:32,244 [trainer.py] => CNN: {'total': 82.65, '00-09': 86.7, '10-19': 82.1, '20-29': 87.1, '30-39': 81.8, '40-49': 82.7, '50-59': 77.2, '60-69': 85.8, '70-79': 75.7, '80-89': 83.3, '90-99': 84.1, 'old': 82.85, 'new': 78.8}
2024-08-25 14:15:32,244 [trainer.py] => CNN top1 curve: [99.6, 97.3, 95.2, 93.9, 93.36, 92.53, 90.2, 89.78, 89.09, 88.3, 86.96, 86.77, 86.34, 86.41, 85.25, 84.05, 83.75, 83.38, 83.29, 82.65]
2024-08-25 14:15:32,244 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.67, 99.55, 99.2, 99.0, 98.77, 98.55, 98.38, 98.26, 97.95, 97.57, 97.45, 97.39, 97.08, 96.84, 96.84, 96.42, 96.39, 96.12]

2024-08-25 14:15:32,244 [trainer.py] => Average Accuracy (CNN): 88.9055