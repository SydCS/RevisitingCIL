2024-08-24 18:48:32,922 [trainer.py] => config: exps/aper_ssf/vtab_10_10_vit-b_ssf.json
2024-08-24 18:48:32,922 [trainer.py] => prefix: exp
2024-08-24 18:48:32,922 [trainer.py] => dataset: vtab
2024-08-24 18:48:32,922 [trainer.py] => memory_size: 2000
2024-08-24 18:48:32,922 [trainer.py] => memory_per_class: 20
2024-08-24 18:48:32,922 [trainer.py] => fixed_memory: False
2024-08-24 18:48:32,922 [trainer.py] => shuffle: False
2024-08-24 18:48:32,922 [trainer.py] => init_cls: 10
2024-08-24 18:48:32,922 [trainer.py] => increment: 10
2024-08-24 18:48:32,922 [trainer.py] => model_name: aper_ssf
2024-08-24 18:48:32,923 [trainer.py] => convnet_type: pretrained_vit_b16_224_in21k_ssf
2024-08-24 18:48:32,923 [trainer.py] => weight_decay: 0.0005
2024-08-24 18:48:32,923 [trainer.py] => prompt_token_num: 30
2024-08-24 18:48:32,923 [trainer.py] => ffn_num: 64
2024-08-24 18:48:32,923 [trainer.py] => optimizer: sgd
2024-08-24 18:48:32,923 [trainer.py] => min_lr: 0
2024-08-24 18:48:32,923 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-24 18:48:32,923 [trainer.py] => seed: 1993
2024-08-24 18:48:32,923 [trainer.py] => tuned_epoch: 20
2024-08-24 18:48:32,923 [trainer.py] => init_lr: 0.01
2024-08-24 18:48:32,923 [trainer.py] => batch_size: 48
2024-08-24 18:48:32,958 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2024-08-24 18:48:35,466 [trainer.py] => All params: 86004480
2024-08-24 18:48:35,467 [trainer.py] => Trainable params: 86004480
2024-08-24 18:48:40,441 [aper_ssf.py] => Learning on 0-10
2024-08-24 18:51:58,818 [aper_ssf.py] => Task 0, Epoch 20/20 => Loss 1.973, Train_accy 62.90, Test_accy 62.00
2024-08-24 18:52:17,152 [trainer.py] => No NME accuracy.
2024-08-24 18:52:17,153 [trainer.py] => CNN: {'total': 90.2, '00-09': 90.2, 'old': 0, 'new': 90.2}
2024-08-24 18:52:17,154 [trainer.py] => CNN top1 curve: [90.2]
2024-08-24 18:52:17,154 [trainer.py] => CNN top5 curve: [98.8]

2024-08-24 18:52:17,155 [trainer.py] => Average Accuracy (CNN): 90.2
2024-08-24 18:52:17,157 [trainer.py] => All params: 171818497
2024-08-24 18:52:17,159 [trainer.py] => Trainable params: 86019841
2024-08-24 18:52:17,166 [aper_ssf.py] => Learning on 10-20
2024-08-24 18:52:34,970 [trainer.py] => No NME accuracy.
2024-08-24 18:52:34,971 [trainer.py] => CNN: {'total': 88.64, '00-09': 90.2, '10-19': 84.75, 'old': 90.2, 'new': 84.75}
2024-08-24 18:52:34,971 [trainer.py] => CNN top1 curve: [90.2, 88.64]
2024-08-24 18:52:34,971 [trainer.py] => CNN top5 curve: [98.8, 98.5]

2024-08-24 18:52:34,971 [trainer.py] => Average Accuracy (CNN): 89.42
2024-08-24 18:52:34,973 [trainer.py] => All params: 171833857
2024-08-24 18:52:34,974 [trainer.py] => Trainable params: 86035201
2024-08-24 18:52:34,983 [aper_ssf.py] => Learning on 20-30
2024-08-24 18:53:04,261 [trainer.py] => No NME accuracy.
2024-08-24 18:53:04,261 [trainer.py] => CNN: {'total': 90.27, '00-09': 90.2, '10-19': 83.25, '20-29': 93.2, 'old': 88.21, 'new': 93.2}
2024-08-24 18:53:04,261 [trainer.py] => CNN top1 curve: [90.2, 88.64, 90.27]
2024-08-24 18:53:04,262 [trainer.py] => CNN top5 curve: [98.8, 98.5, 98.74]

2024-08-24 18:53:04,262 [trainer.py] => Average Accuracy (CNN): 89.70333333333333
2024-08-24 18:53:04,264 [trainer.py] => All params: 171849217
2024-08-24 18:53:04,265 [trainer.py] => Trainable params: 86050561
2024-08-24 18:53:04,275 [aper_ssf.py] => Learning on 30-40
2024-08-24 18:54:30,514 [trainer.py] => No NME accuracy.
2024-08-24 18:54:30,514 [trainer.py] => CNN: {'total': 80.46, '00-09': 89.6, '10-19': 83.0, '20-29': 93.2, '30-39': 76.26, 'old': 89.98, 'new': 76.26}
2024-08-24 18:54:30,514 [trainer.py] => CNN top1 curve: [90.2, 88.64, 90.27, 80.46]
2024-08-24 18:54:30,514 [trainer.py] => CNN top5 curve: [98.8, 98.5, 98.74, 98.64]

2024-08-24 18:54:30,514 [trainer.py] => Average Accuracy (CNN): 87.3925
2024-08-24 18:54:30,516 [trainer.py] => All params: 171864577
2024-08-24 18:54:30,517 [trainer.py] => Trainable params: 86065921
2024-08-24 18:54:30,523 [aper_ssf.py] => Learning on 40-50
2024-08-24 18:55:40,071 [trainer.py] => No NME accuracy.
2024-08-24 18:55:40,071 [trainer.py] => CNN: {'total': 82.34, '00-09': 89.6, '10-19': 82.75, '20-29': 93.2, '30-39': 76.26, '40-49': 100.0, 'old': 80.45, 'new': 100.0}
2024-08-24 18:55:40,071 [trainer.py] => CNN top1 curve: [90.2, 88.64, 90.27, 80.46, 82.34]
2024-08-24 18:55:40,071 [trainer.py] => CNN top5 curve: [98.8, 98.5, 98.74, 98.64, 98.75]

2024-08-24 18:55:40,071 [trainer.py] => Average Accuracy (CNN): 86.38199999999999
