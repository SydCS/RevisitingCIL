2024-09-10 19:33:19,687 [trainer.py] => config: ./exps/adam_ssf.json
2024-09-10 19:33:19,687 [trainer.py] => prefix:  
2024-09-10 19:33:19,687 [trainer.py] => dataset: cifar224
2024-09-10 19:33:19,687 [trainer.py] => memory_size: 0
2024-09-10 19:33:19,687 [trainer.py] => memory_per_class: 0
2024-09-10 19:33:19,687 [trainer.py] => fixed_memory: False
2024-09-10 19:33:19,687 [trainer.py] => shuffle: True
2024-09-10 19:33:19,687 [trainer.py] => init_cls: 10
2024-09-10 19:33:19,687 [trainer.py] => increment: 10
2024-09-10 19:33:19,687 [trainer.py] => model_name: adam_ssf
2024-09-10 19:33:19,687 [trainer.py] => convnet_type: pretrained_vit_b16_224_in21k_ssf
2024-09-10 19:33:19,687 [trainer.py] => device: [device(type='cuda', index=0)]
2024-09-10 19:33:19,687 [trainer.py] => seed: 1993
2024-09-10 19:33:19,687 [trainer.py] => tuned_epoch: 20
2024-09-10 19:33:19,687 [trainer.py] => init_lr: 0.01
2024-09-10 19:33:19,687 [trainer.py] => batch_size: 48
2024-09-10 19:33:19,687 [trainer.py] => weight_decay: 0.0005
2024-09-10 19:33:19,687 [trainer.py] => min_lr: 0
2024-09-10 19:33:19,687 [trainer.py] => ffn_num: 64
2024-09-10 19:33:19,687 [trainer.py] => optimizer: sgd
2024-09-10 19:33:19,688 [trainer.py] => vpt_type: shallow
2024-09-10 19:33:19,688 [trainer.py] => prompt_token_num: 5
2024-09-10 19:33:44,288 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-10 19:33:45,543 [hub.py] => Downloading: "https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0.npz" to /home/yg/.cache/torch/hub/checkpoints/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0.npz

2024-09-10 19:34:19,068 [trainer.py] => All params: 86004480
2024-09-10 19:34:19,068 [trainer.py] => Trainable params: 86004480
2024-09-10 19:34:19,878 [adam_ssf.py] => Learning on 0-10
2024-09-10 19:41:14,673 [adam_ssf.py] => Task 0, Epoch 20/20 => Loss 0.195, Train_accy 94.40, Test_accy 98.80
2024-09-10 19:41:35,632 [trainer.py] => No NME accuracy.
2024-09-10 19:41:35,632 [trainer.py] => CNN: {'total': 99.0, '00-09': 99.0, 'old': 0, 'new': 99.0}
2024-09-10 19:41:35,632 [trainer.py] => CNN top1 curve: [99.0]
2024-09-10 19:41:35,632 [trainer.py] => CNN top5 curve: [100.0]

2024-09-10 19:41:35,632 [trainer.py] => Average Accuracy (CNN): 99.0
2024-09-10 19:41:35,633 [trainer.py] => All params: 171818497
2024-09-10 19:41:35,634 [trainer.py] => Trainable params: 86019841
2024-09-10 19:41:35,643 [adam_ssf.py] => Learning on 10-20
2024-09-10 19:41:57,296 [trainer.py] => No NME accuracy.
2024-09-10 19:41:57,296 [trainer.py] => CNN: {'total': 96.25, '00-09': 98.7, '10-19': 93.8, 'old': 98.7, 'new': 93.8}
2024-09-10 19:41:57,297 [trainer.py] => CNN top1 curve: [99.0, 96.25]
2024-09-10 19:41:57,297 [trainer.py] => CNN top5 curve: [100.0, 99.65]

2024-09-10 19:41:57,297 [trainer.py] => Average Accuracy (CNN): 97.625
2024-09-10 19:41:57,298 [trainer.py] => All params: 171833857
2024-09-10 19:41:57,298 [trainer.py] => Trainable params: 86035201
2024-09-10 19:41:57,299 [adam_ssf.py] => Learning on 20-30
2024-09-10 19:42:21,936 [trainer.py] => No NME accuracy.
2024-09-10 19:42:21,936 [trainer.py] => CNN: {'total': 94.83, '00-09': 97.1, '10-19': 92.4, '20-29': 95.0, 'old': 94.75, 'new': 95.0}
2024-09-10 19:42:21,936 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83]
2024-09-10 19:42:21,936 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47]

2024-09-10 19:42:21,936 [trainer.py] => Average Accuracy (CNN): 96.69333333333333
2024-09-10 19:42:21,938 [trainer.py] => All params: 171849217
2024-09-10 19:42:21,940 [trainer.py] => Trainable params: 86050561
2024-09-10 19:42:21,941 [adam_ssf.py] => Learning on 30-40
2024-09-10 19:42:49,499 [trainer.py] => No NME accuracy.
2024-09-10 19:42:49,499 [trainer.py] => CNN: {'total': 92.2, '00-09': 96.4, '10-19': 90.4, '20-29': 93.9, '30-39': 88.1, 'old': 93.57, 'new': 88.1}
2024-09-10 19:42:49,499 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2]
2024-09-10 19:42:49,500 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1]

2024-09-10 19:42:49,500 [trainer.py] => Average Accuracy (CNN): 95.57
2024-09-10 19:42:49,501 [trainer.py] => All params: 171864577
2024-09-10 19:42:49,502 [trainer.py] => Trainable params: 86065921
2024-09-10 19:42:49,503 [adam_ssf.py] => Learning on 40-50
2024-09-10 19:43:19,933 [trainer.py] => No NME accuracy.
2024-09-10 19:43:19,934 [trainer.py] => CNN: {'total': 90.06, '00-09': 95.3, '10-19': 88.7, '20-29': 92.8, '30-39': 85.2, '40-49': 88.3, 'old': 90.5, 'new': 88.3}
2024-09-10 19:43:19,934 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2, 90.06]
2024-09-10 19:43:19,934 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1, 98.68]

2024-09-10 19:43:19,934 [trainer.py] => Average Accuracy (CNN): 94.46799999999999
2024-09-10 19:43:19,935 [trainer.py] => All params: 171879937
2024-09-10 19:43:19,936 [trainer.py] => Trainable params: 86081281
2024-09-10 19:43:19,936 [adam_ssf.py] => Learning on 50-60
2024-09-10 19:43:53,309 [trainer.py] => No NME accuracy.
2024-09-10 19:43:53,309 [trainer.py] => CNN: {'total': 88.62, '00-09': 94.5, '10-19': 88.4, '20-29': 92.0, '30-39': 84.5, '40-49': 86.7, '50-59': 85.6, 'old': 89.22, 'new': 85.6}
2024-09-10 19:43:53,309 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2, 90.06, 88.62]
2024-09-10 19:43:53,309 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1, 98.68, 98.25]

2024-09-10 19:43:53,309 [trainer.py] => Average Accuracy (CNN): 93.49333333333334
2024-09-10 19:43:53,310 [trainer.py] => All params: 171895297
2024-09-10 19:43:53,311 [trainer.py] => Trainable params: 86096641
2024-09-10 19:43:53,312 [adam_ssf.py] => Learning on 60-70
2024-09-10 19:44:29,646 [trainer.py] => No NME accuracy.
2024-09-10 19:44:29,646 [trainer.py] => CNN: {'total': 88.21, '00-09': 93.9, '10-19': 87.8, '20-29': 91.9, '30-39': 84.4, '40-49': 86.5, '50-59': 83.3, '60-69': 89.7, 'old': 87.97, 'new': 89.7}
2024-09-10 19:44:29,646 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2, 90.06, 88.62, 88.21]
2024-09-10 19:44:29,646 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1, 98.68, 98.25, 98.24]

2024-09-10 19:44:29,646 [trainer.py] => Average Accuracy (CNN): 92.73857142857143
2024-09-10 19:44:29,647 [trainer.py] => All params: 171910657
2024-09-10 19:44:29,648 [trainer.py] => Trainable params: 86112001
2024-09-10 19:44:29,649 [adam_ssf.py] => Learning on 70-80
2024-09-10 19:45:09,038 [trainer.py] => No NME accuracy.
2024-09-10 19:45:09,038 [trainer.py] => CNN: {'total': 86.18, '00-09': 93.8, '10-19': 87.1, '20-29': 91.8, '30-39': 83.5, '40-49': 84.5, '50-59': 80.4, '60-69': 87.2, '70-79': 81.1, 'old': 86.9, 'new': 81.1}
2024-09-10 19:45:09,038 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2, 90.06, 88.62, 88.21, 86.18]
2024-09-10 19:45:09,039 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1, 98.68, 98.25, 98.24, 97.9]

2024-09-10 19:45:09,039 [trainer.py] => Average Accuracy (CNN): 91.91875000000002
2024-09-10 19:45:09,040 [trainer.py] => All params: 171926017
2024-09-10 19:45:09,042 [trainer.py] => Trainable params: 86127361
2024-09-10 19:45:09,044 [adam_ssf.py] => Learning on 80-90
2024-09-10 19:45:51,140 [trainer.py] => No NME accuracy.
2024-09-10 19:45:51,140 [trainer.py] => CNN: {'total': 85.69, '00-09': 93.5, '10-19': 85.8, '20-29': 91.3, '30-39': 83.4, '40-49': 83.3, '50-59': 79.9, '60-69': 86.2, '70-79': 80.8, '80-89': 87.0, 'old': 85.52, 'new': 87.0}
2024-09-10 19:45:51,141 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2, 90.06, 88.62, 88.21, 86.18, 85.69]
2024-09-10 19:45:51,141 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1, 98.68, 98.25, 98.24, 97.9, 97.59]

2024-09-10 19:45:51,141 [trainer.py] => Average Accuracy (CNN): 91.22666666666669
2024-09-10 19:45:51,142 [trainer.py] => All params: 171941377
2024-09-10 19:45:51,142 [trainer.py] => Trainable params: 86142721
2024-09-10 19:45:51,144 [adam_ssf.py] => Learning on 90-100
2024-09-10 19:46:36,305 [trainer.py] => No NME accuracy.
2024-09-10 19:46:36,305 [trainer.py] => CNN: {'total': 85.13, '00-09': 93.0, '10-19': 85.2, '20-29': 90.9, '30-39': 83.0, '40-49': 82.2, '50-59': 79.1, '60-69': 86.0, '70-79': 79.7, '80-89': 86.3, '90-99': 85.9, 'old': 85.04, 'new': 85.9}
2024-09-10 19:46:36,305 [trainer.py] => CNN top1 curve: [99.0, 96.25, 94.83, 92.2, 90.06, 88.62, 88.21, 86.18, 85.69, 85.13]
2024-09-10 19:46:36,305 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.47, 99.1, 98.68, 98.25, 98.24, 97.9, 97.59, 97.26]

2024-09-10 19:46:36,305 [trainer.py] => Average Accuracy (CNN): 90.61700000000002
