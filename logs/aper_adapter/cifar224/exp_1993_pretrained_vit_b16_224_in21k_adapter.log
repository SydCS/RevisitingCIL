2024-08-24 14:30:46,597 [trainer.py] => config: exps/aper_adapter/cifar224_5_5_vit-b_adapter.json
2024-08-24 14:30:46,597 [trainer.py] => prefix: exp
2024-08-24 14:30:46,597 [trainer.py] => dataset: cifar224
2024-08-24 14:30:46,597 [trainer.py] => memory_size: 2000
2024-08-24 14:30:46,597 [trainer.py] => memory_per_class: 20
2024-08-24 14:30:46,597 [trainer.py] => fixed_memory: False
2024-08-24 14:30:46,597 [trainer.py] => shuffle: True
2024-08-24 14:30:46,597 [trainer.py] => init_cls: 5
2024-08-24 14:30:46,598 [trainer.py] => increment: 5
2024-08-24 14:30:46,598 [trainer.py] => model_name: aper_adapter
2024-08-24 14:30:46,598 [trainer.py] => convnet_type: pretrained_vit_b16_224_in21k_adapter
2024-08-24 14:30:46,598 [trainer.py] => weight_decay: 0.0005
2024-08-24 14:30:46,598 [trainer.py] => prompt_token_num: 30
2024-08-24 14:30:46,598 [trainer.py] => ffn_num: 64
2024-08-24 14:30:46,598 [trainer.py] => optimizer: sgd
2024-08-24 14:30:46,598 [trainer.py] => min_lr: 0
2024-08-24 14:30:46,598 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-24 14:30:46,598 [trainer.py] => seed: 1993
2024-08-24 14:30:46,598 [trainer.py] => tuned_epoch: 20
2024-08-24 14:30:46,598 [trainer.py] => init_lr: 0.01
2024-08-24 14:30:46,598 [trainer.py] => batch_size: 48
2024-08-24 14:30:48,553 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-24 14:30:51,980 [trainer.py] => All params: 86988288
2024-08-24 14:30:51,981 [trainer.py] => Trainable params: 1189632
2024-08-24 14:30:55,386 [aper_adapter.py] => Learning on 0-5
2024-08-24 14:34:30,653 [aper_adapter.py] => Task 0, Epoch 20/20 => Loss 0.186, Train_accy 94.84, Test_accy 99.60
2024-08-24 14:34:53,869 [trainer.py] => No NME accuracy.
2024-08-24 14:34:53,871 [trainer.py] => CNN: {'total': 98.8, '00-09': 98.8, 'old': 0, 'new': 98.8}
2024-08-24 14:34:53,871 [trainer.py] => CNN top1 curve: [98.8]
2024-08-24 14:34:53,871 [trainer.py] => CNN top5 curve: [100.0]

2024-08-24 14:34:53,871 [trainer.py] => Average Accuracy (CNN): 98.8
2024-08-24 14:34:53,873 [trainer.py] => All params: 172794625
2024-08-24 14:34:53,874 [trainer.py] => Trainable params: 86995969
2024-08-24 14:34:53,881 [aper_adapter.py] => Learning on 5-10
2024-08-24 14:35:16,080 [trainer.py] => No NME accuracy.
2024-08-24 14:35:16,080 [trainer.py] => CNN: {'total': 97.2, '00-09': 97.2, 'old': 97.8, 'new': 96.6}
2024-08-24 14:35:16,080 [trainer.py] => CNN top1 curve: [98.8, 97.2]
2024-08-24 14:35:16,080 [trainer.py] => CNN top5 curve: [100.0, 99.9]

2024-08-24 14:35:16,080 [trainer.py] => Average Accuracy (CNN): 98.0
2024-08-24 14:35:16,082 [trainer.py] => All params: 172802305
2024-08-24 14:35:16,083 [trainer.py] => Trainable params: 87003649
2024-08-24 14:35:16,090 [aper_adapter.py] => Learning on 10-15
2024-08-24 14:35:39,631 [trainer.py] => No NME accuracy.
2024-08-24 14:35:39,631 [trainer.py] => CNN: {'total': 96.27, '00-09': 96.4, '10-19': 96.0, 'old': 96.4, 'new': 96.0}
2024-08-24 14:35:39,631 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27]
2024-08-24 14:35:39,631 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53]

2024-08-24 14:35:39,632 [trainer.py] => Average Accuracy (CNN): 97.42333333333333
2024-08-24 14:35:39,634 [trainer.py] => All params: 172809985
2024-08-24 14:35:39,635 [trainer.py] => Trainable params: 87011329
2024-08-24 14:35:39,637 [aper_adapter.py] => Learning on 15-20
2024-08-24 14:36:14,047 [trainer.py] => No NME accuracy.
2024-08-24 14:36:14,047 [trainer.py] => CNN: {'total': 94.6, '00-09': 95.8, '10-19': 93.4, 'old': 95.67, 'new': 91.4}
2024-08-24 14:36:14,047 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6]
2024-08-24 14:36:14,047 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25]

2024-08-24 14:36:14,048 [trainer.py] => Average Accuracy (CNN): 96.7175
2024-08-24 14:36:14,049 [trainer.py] => All params: 172817665
2024-08-24 14:36:14,051 [trainer.py] => Trainable params: 87019009
2024-08-24 14:36:14,059 [aper_adapter.py] => Learning on 20-25
2024-08-24 14:36:55,862 [trainer.py] => No NME accuracy.
2024-08-24 14:36:55,863 [trainer.py] => CNN: {'total': 94.32, '00-09': 95.4, '10-19': 92.6, '20-29': 95.6, 'old': 94.0, 'new': 95.6}
2024-08-24 14:36:55,863 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32]
2024-08-24 14:36:55,863 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88]

2024-08-24 14:36:55,863 [trainer.py] => Average Accuracy (CNN): 96.238
2024-08-24 14:36:55,865 [trainer.py] => All params: 172825345
2024-08-24 14:36:55,866 [trainer.py] => Trainable params: 87026689
2024-08-24 14:36:55,876 [aper_adapter.py] => Learning on 25-30
2024-08-24 14:37:43,924 [trainer.py] => No NME accuracy.
2024-08-24 14:37:43,924 [trainer.py] => CNN: {'total': 93.67, '00-09': 94.2, '10-19': 91.9, '20-29': 94.9, 'old': 93.56, 'new': 94.2}
2024-08-24 14:37:43,924 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67]
2024-08-24 14:37:43,925 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83]

2024-08-24 14:37:43,925 [trainer.py] => Average Accuracy (CNN): 95.81
2024-08-24 14:37:43,926 [trainer.py] => All params: 172833025
2024-08-24 14:37:43,928 [trainer.py] => Trainable params: 87034369
2024-08-24 14:37:43,932 [aper_adapter.py] => Learning on 30-35
2024-08-24 14:38:26,897 [trainer.py] => No NME accuracy.
2024-08-24 14:38:26,897 [trainer.py] => CNN: {'total': 92.26, '00-09': 93.8, '10-19': 90.8, '20-29': 94.6, '30-39': 87.4, 'old': 93.07, 'new': 87.4}
2024-08-24 14:38:26,897 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26]
2024-08-24 14:38:26,897 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89]

2024-08-24 14:38:26,897 [trainer.py] => Average Accuracy (CNN): 95.30285714285715
2024-08-24 14:38:26,899 [trainer.py] => All params: 172840705
2024-08-24 14:38:26,900 [trainer.py] => Trainable params: 87042049
2024-08-24 14:38:26,902 [aper_adapter.py] => Learning on 35-40
2024-08-24 14:39:05,457 [trainer.py] => No NME accuracy.
2024-08-24 14:39:05,457 [trainer.py] => CNN: {'total': 92.02, '00-09': 92.7, '10-19': 90.3, '20-29': 94.1, '30-39': 91.0, 'old': 91.6, 'new': 95.0}
2024-08-24 14:39:05,457 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02]
2024-08-24 14:39:05,457 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72]

2024-08-24 14:39:05,457 [trainer.py] => Average Accuracy (CNN): 94.8925
2024-08-24 14:39:05,459 [trainer.py] => All params: 172848385
2024-08-24 14:39:05,460 [trainer.py] => Trainable params: 87049729
2024-08-24 14:39:05,462 [aper_adapter.py] => Learning on 40-45
2024-08-24 14:39:52,979 [trainer.py] => No NME accuracy.
2024-08-24 14:39:52,979 [trainer.py] => CNN: {'total': 91.31, '00-09': 92.1, '10-19': 89.6, '20-29': 94.0, '30-39': 90.7, '40-49': 89.0, 'old': 91.6, 'new': 89.0}
2024-08-24 14:39:52,979 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31]
2024-08-24 14:39:52,979 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51]

2024-08-24 14:39:52,979 [trainer.py] => Average Accuracy (CNN): 94.49444444444445
2024-08-24 14:39:52,981 [trainer.py] => All params: 172856065
2024-08-24 14:39:52,982 [trainer.py] => Trainable params: 87057409
2024-08-24 14:39:52,987 [aper_adapter.py] => Learning on 45-50
2024-08-24 14:40:35,331 [trainer.py] => No NME accuracy.
2024-08-24 14:40:35,332 [trainer.py] => CNN: {'total': 90.34, '00-09': 91.3, '10-19': 88.7, '20-29': 93.0, '30-39': 88.7, '40-49': 90.0, 'old': 90.22, 'new': 91.4}
2024-08-24 14:40:35,332 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34]
2024-08-24 14:40:35,332 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44]

2024-08-24 14:40:35,332 [trainer.py] => Average Accuracy (CNN): 94.07900000000001
2024-08-24 14:40:35,333 [trainer.py] => All params: 172863745
2024-08-24 14:40:35,335 [trainer.py] => Trainable params: 87065089
2024-08-24 14:40:35,339 [aper_adapter.py] => Learning on 50-55
2024-08-24 14:41:12,786 [trainer.py] => No NME accuracy.
2024-08-24 14:41:12,786 [trainer.py] => CNN: {'total': 89.07, '00-09': 90.3, '10-19': 88.6, '20-29': 92.1, '30-39': 88.3, '40-49': 87.7, '50-59': 85.8, 'old': 89.4, 'new': 85.8}
2024-08-24 14:41:12,787 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07]
2024-08-24 14:41:12,787 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18]

2024-08-24 14:41:12,787 [trainer.py] => Average Accuracy (CNN): 93.62363636363638
2024-08-24 14:41:12,788 [trainer.py] => All params: 172871425
2024-08-24 14:41:12,790 [trainer.py] => Trainable params: 87072769
2024-08-24 14:41:12,792 [aper_adapter.py] => Learning on 55-60
2024-08-24 14:41:54,752 [trainer.py] => No NME accuracy.
2024-08-24 14:41:54,752 [trainer.py] => CNN: {'total': 88.93, '00-09': 90.1, '10-19': 88.6, '20-29': 91.8, '30-39': 87.9, '40-49': 87.6, '50-59': 87.6, 'old': 88.89, 'new': 89.4}
2024-08-24 14:41:54,753 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93]
2024-08-24 14:41:54,753 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92]

2024-08-24 14:41:54,753 [trainer.py] => Average Accuracy (CNN): 93.23250000000002
2024-08-24 14:41:54,754 [trainer.py] => All params: 172879105
2024-08-24 14:41:54,756 [trainer.py] => Trainable params: 87080449
2024-08-24 14:41:54,761 [aper_adapter.py] => Learning on 60-65
2024-08-24 14:42:37,657 [trainer.py] => No NME accuracy.
2024-08-24 14:42:37,658 [trainer.py] => CNN: {'total': 88.51, '00-09': 90.0, '10-19': 88.4, '20-29': 91.8, '30-39': 87.6, '40-49': 87.6, '50-59': 85.3, '60-69': 89.2, 'old': 88.45, 'new': 89.2}
2024-08-24 14:42:37,658 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51]
2024-08-24 14:42:37,658 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92]

2024-08-24 14:42:37,658 [trainer.py] => Average Accuracy (CNN): 92.86923076923078
2024-08-24 14:42:37,659 [trainer.py] => All params: 172886785
2024-08-24 14:42:37,661 [trainer.py] => Trainable params: 87088129
2024-08-24 14:42:37,662 [aper_adapter.py] => Learning on 65-70
2024-08-24 14:43:24,072 [trainer.py] => No NME accuracy.
2024-08-24 14:43:24,073 [trainer.py] => CNN: {'total': 88.53, '00-09': 89.1, '10-19': 87.7, '20-29': 91.8, '30-39': 87.4, '40-49': 87.4, '50-59': 85.2, '60-69': 91.1, 'old': 88.11, 'new': 94.0}
2024-08-24 14:43:24,073 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53]
2024-08-24 14:43:24,073 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91]

2024-08-24 14:43:24,073 [trainer.py] => Average Accuracy (CNN): 92.55928571428572
2024-08-24 14:43:24,075 [trainer.py] => All params: 172894465
2024-08-24 14:43:24,076 [trainer.py] => Trainable params: 87095809
2024-08-24 14:43:24,081 [aper_adapter.py] => Learning on 70-75
2024-08-24 14:44:15,268 [trainer.py] => No NME accuracy.
2024-08-24 14:44:15,268 [trainer.py] => CNN: {'total': 87.61, '00-09': 88.9, '10-19': 87.0, '20-29': 91.7, '30-39': 86.7, '40-49': 87.2, '50-59': 84.7, '60-69': 89.3, '70-79': 83.2, 'old': 87.93, 'new': 83.2}
2024-08-24 14:44:15,268 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53, 87.61]
2024-08-24 14:44:15,268 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91, 97.65]

2024-08-24 14:44:15,268 [trainer.py] => Average Accuracy (CNN): 92.22933333333334
2024-08-24 14:44:15,270 [trainer.py] => All params: 172902145
2024-08-24 14:44:15,271 [trainer.py] => Trainable params: 87103489
2024-08-24 14:44:15,277 [aper_adapter.py] => Learning on 75-80
2024-08-24 14:45:08,754 [trainer.py] => No NME accuracy.
2024-08-24 14:45:08,754 [trainer.py] => CNN: {'total': 86.35, '00-09': 88.4, '10-19': 86.9, '20-29': 91.5, '30-39': 86.7, '40-49': 84.8, '50-59': 83.0, '60-69': 88.8, '70-79': 80.7, 'old': 86.79, 'new': 79.8}
2024-08-24 14:45:08,754 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53, 87.61, 86.35]
2024-08-24 14:45:08,754 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91, 97.65, 97.49]

2024-08-24 14:45:08,754 [trainer.py] => Average Accuracy (CNN): 91.861875
2024-08-24 14:45:08,756 [trainer.py] => All params: 172909825
2024-08-24 14:45:08,757 [trainer.py] => Trainable params: 87111169
2024-08-24 14:45:08,763 [aper_adapter.py] => Learning on 80-85
2024-08-24 14:46:04,447 [trainer.py] => No NME accuracy.
2024-08-24 14:46:04,447 [trainer.py] => CNN: {'total': 86.04, '00-09': 87.9, '10-19': 86.2, '20-29': 91.2, '30-39': 86.5, '40-49': 83.7, '50-59': 82.7, '60-69': 88.1, '70-79': 80.5, '80-89': 89.0, 'old': 85.85, 'new': 89.0}
2024-08-24 14:46:04,447 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53, 87.61, 86.35, 86.04]
2024-08-24 14:46:04,447 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91, 97.65, 97.49, 97.36]

2024-08-24 14:46:04,447 [trainer.py] => Average Accuracy (CNN): 91.51941176470588
2024-08-24 14:46:04,449 [trainer.py] => All params: 172917505
2024-08-24 14:46:04,450 [trainer.py] => Trainable params: 87118849
2024-08-24 14:46:04,452 [aper_adapter.py] => Learning on 85-90
2024-08-24 14:47:02,458 [trainer.py] => No NME accuracy.
2024-08-24 14:47:02,458 [trainer.py] => CNN: {'total': 85.63, '00-09': 87.4, '10-19': 85.7, '20-29': 91.2, '30-39': 86.5, '40-49': 83.7, '50-59': 82.4, '60-69': 88.1, '70-79': 79.9, '80-89': 85.8, 'old': 85.81, 'new': 82.6}
2024-08-24 14:47:02,458 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53, 87.61, 86.35, 86.04, 85.63]
2024-08-24 14:47:02,459 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91, 97.65, 97.49, 97.36, 97.16]

2024-08-24 14:47:02,459 [trainer.py] => Average Accuracy (CNN): 91.19222222222223
2024-08-24 14:47:02,460 [trainer.py] => All params: 172925185
2024-08-24 14:47:02,462 [trainer.py] => Trainable params: 87126529
2024-08-24 14:47:02,467 [aper_adapter.py] => Learning on 90-95
2024-08-24 14:48:03,729 [trainer.py] => No NME accuracy.
2024-08-24 14:48:03,729 [trainer.py] => CNN: {'total': 85.64, '00-09': 86.8, '10-19': 85.6, '20-29': 90.5, '30-39': 86.3, '40-49': 83.4, '50-59': 81.9, '60-69': 88.1, '70-79': 79.4, '80-89': 85.6, '90-99': 92.0, 'old': 85.29, 'new': 92.0}
2024-08-24 14:48:03,729 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53, 87.61, 86.35, 86.04, 85.63, 85.64]
2024-08-24 14:48:03,730 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91, 97.65, 97.49, 97.36, 97.16, 97.12]

2024-08-24 14:48:03,730 [trainer.py] => Average Accuracy (CNN): 90.9
2024-08-24 14:48:03,731 [trainer.py] => All params: 172932865
2024-08-24 14:48:03,732 [trainer.py] => Trainable params: 87134209
2024-08-24 14:48:03,737 [aper_adapter.py] => Learning on 95-100
2024-08-24 14:49:07,656 [trainer.py] => No NME accuracy.
2024-08-24 14:49:07,657 [trainer.py] => CNN: {'total': 85.14, '00-09': 86.5, '10-19': 85.1, '20-29': 90.3, '30-39': 86.1, '40-49': 83.1, '50-59': 81.3, '60-69': 87.9, '70-79': 79.2, '80-89': 85.3, '90-99': 86.6, 'old': 85.33, 'new': 81.6}
2024-08-24 14:49:07,657 [trainer.py] => CNN top1 curve: [98.8, 97.2, 96.27, 94.6, 94.32, 93.67, 92.26, 92.02, 91.31, 90.34, 89.07, 88.93, 88.51, 88.53, 87.61, 86.35, 86.04, 85.63, 85.64, 85.14]
2024-08-24 14:49:07,657 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.53, 99.25, 98.88, 98.83, 98.89, 98.72, 98.51, 98.44, 98.18, 97.92, 97.92, 97.91, 97.65, 97.49, 97.36, 97.16, 97.12, 96.87]

2024-08-24 14:49:07,657 [trainer.py] => Average Accuracy (CNN): 90.61200000000001
